<!-- Dialog that is shown when the user wishes to create a new trail -->
<div id="editTrailDetailsDialog" title="Trail details">
	<form action="{{ updateUrl }}" method="POST" id="editTrailDetailsForm">
		<input type="hidden" name="trailId" value="{{ trailId }}"/>
		<div id="optionalInfo">
			<table>
				<tbody>
					<tr>
						<td><label for="directions">Directions</label></td>
						<td>
							<textarea name="directions" id="directions">{{ trailDetails.directions }}</textarea>
						</td>
					</tr>
					<tr>
						<td><label for="recommendations">Recommendations:</label></td>
						<td>
							<textarea name="recommendations" id="recommendations">{{ trailDetails.recommendations }}</textarea>
						</td>
					</tr>
					<tr>
						<td><label for="recommendedSeason">Recommended time of year:</label></td>
						<td>
							<select name="recommendedSeason" id="recommendedSeason">
								<option value="Any">Any</option>
								<option value="Spring">Spring</option>
								<option value="Summer">Summer</option>
								<option value="Autumn">Autumn</option>
								<option value="Winter">Winter</option>
							</select>
							<script type="text/javascript">
								$(function(){
									$("#recommendedSeason").children("option[value='{{ trailDetails.recommendedSeason }}'").attr("selected", "selected");
								});
							</script>							
						</td>
					</tr>
				</tbody>
			</table>
			<hr/>
			<div>
				Links:
				<div id="linksHolder">
					<p>
						<input type="text" name="link" value="http://" />
					</p>
				</div>
				<div id="addLinkBtn">Add link</div>
				<div id="removeLinkBtn">Remove last link</div>
				<script type="text/javascript">
					$(function(){
						$("#addLinkBtn").button()
							.click(function() {
								$("#linksHolder").append("<p><input type='text' name='link' value='http:\/\/' /></p>");
							});

						$("#removeLinkBtn").button().click(function() {
							$("#linksHolder").find("p:last").remove();
						});
					});
				
				</script>
			</div>
		</div>
	</form>
</div>

<script type="text/javascript">
	$(function() {
	
		$("#editTrailDetailsForm").ajaxForm({
			beforeSubmit: function(){
				$.jnotify("Updating trail details, standby...", true);
			},
			success: function(){ window.location.reload(true); }
		}); 	
	
		$("#editTrailDetailsDialog").dialog({
			autoOpen : false,
			modal : true,
			width : 600,
			buttons : {
				"Submit" : function() {
					$("#editTrailDetailsForm").submit();
					$(this).dialog('close');
				},
				"Close" : function() {
					$(this).dialog('close');
				}
			}
		});

	});
</script>