<!-- Dialog that is shown when the user wishes to create a new trail -->
<div id="updateTrailDialog" title="Edit location">
	<form action="{{ uploadUrl }}" method="POST" id="updateTrailForm" enctype="multipart/form-data">
			<div id="mandatoryInfo">
				<table>
					<tbody>
						<tr>
							<td><label for="title">Trail name</label></td>
							<td>
								<input type="text" name="title" id="title" value="{{ trail.title }}"/>
							</td>
						</tr>
						<tr>
							<td><label for="credentialNumber">Credential number</label>
							</td>
							<td>
								<input type="text" name="credentialNumber" id="credentialNumber" value="{{ trail.credentialNumber }}"/>
							</td>
						</tr>
						<tr>
							<td>Difficulty</td>
							<td>
								<div id="difficultyBtns">
									<input type="radio" id="difficulty_easy" name="difficulty"
										value="easy" /><label for="difficulty_easy">Easy</label> <input
										type="radio" id="difficulty_moderate" name="difficulty"
										value="moderate" checked="checked" /><label
										for="difficulty_moderate">Moderate</label> <input type="radio"
										id="difficulty_hard" name="difficulty" value="hard" /><label
										for="difficulty_hard">Hard</label>							
								</div>
								<script type="text/javascript">
									$(function(){
										$("#difficultyBtns").children("input[value='{{ trail.difficulty }}']").attr("checked", "checked");
									});
								</script>	
							</td>
						</tr>
						<tr>
							<td><label for="condition">Condition</label></td>
							<td><select name="condition" id="condition">
									<option value="excellent">Excellent</option>
									<option value="good">Good</option>
									<option value="moderate">Moderate</option>
									<option value="bad">Bad</option>
									<option value="impossible">Impossible</option>
							</select>
							<script type="text/javascript">
								$(function(){
									$("#condition").children("option[value='{{ trail.condition }}']").attr("selected", "selected");
								});
							</script>
							</td>
						</tr>
						<tr>
							<td>Region</td>
							<td>
								<div id="regionBtns">
									<input type="radio" id="region_north" name="region"
										value="north" /><label for="region_north">North</label> <input
										type="radio" id="region_center" name="region" value="center"
										checked="checked" /><label for="region_center">Center</label>
									<input type="radio" id="region_south" name="region"
										value="south" /><label for="region_south">South</label>
								</div>
								<script type="text/javascript">
									$(function(){
										$("#regionBtns").children("input[value='{{ trail.region }}']").attr("checked", "checked");
									});
								</script>								
								</td>
						</tr>
						<tr>
							<td><label for="nearestCity">Nearest city</label></td>
							<td>
								<input type="text" name="nearestCity" id="nearestCity" value="{{ trail.nearestCity }}"/>
							</td>
						</tr>
						<tr>
							<td><label for="tags">Tags</label></td>
							<td><input type="text" name="tags" value="tags" id="tags" value="{{ trail.tags }}"/></td>
						</tr>
						<tr>
							<td colspan="2">
								<input type="checkbox" name="changeFile" id="changeFile"/>
								<label for="changeFile">Change file:</label>
								<script type="text/javascript">
									$("#changeFile").change(function(){
										if($(this).is(":checked")){
											$("#fileUploadRow").show('slow');
										}else{
											$("#fileUploadRow").hide('slow');
										}
									}).trigger('change');
								</script>
							</td>
						</tr>
						<tr id="fileUploadRow">
							<td><label for="file">KML File:</label></td>
							<td><input type="file" name="file" id="file" /></td>
						</tr>
					</tbody>
				</table>
			</div>
	</form>
</div>

<script type="text/javascript">
	$(function() {

		$("#updateTrailForm").ajaxForm({
			beforeSubmit: function(){
				$.jnotify("Processing update, standby...", true);
			},
			success: function(){ window.location.reload(true); },
			type: "PUT"
		}); 

		$("#updateTrailDialog").dialog({
			autoOpen : false,
			modal : true,
			width : 600,
			buttons : {
				"Submit" : function() {
					$("#updateTrailForm").submit();
					$(this).dialog('close');
				},
				"Close" : function() {
					$(this).dialog('close');
				}
			}
		});

		$("#addLinkBtn")
				.button()
				.click(
						function() {
							$("#linksHolder")
									.append(
											"<p><input type='text' name='link' value='http:\/\/' /></p>");
						});

		$("#removeLinkBtn").button().click(function() {
			$("#linksHolder").find("p:last").remove();
		});
	});
</script>